<h1 id="gestionTitle" class="ms-3">Adopción de IA</h1>
<div class="p-3">
  <form [formGroup]="projectForm" (ngSubmit)="onSubmit()">
    <div class="fixed-header">
      <div class="row d-flex flex-row justify-content-around">
        <div class="col-4">
          <label for="proyecto" class="col-12">PROYECTO</label>
          <mat-select
            id="proyecto"
            class="col-12"
            [ngClass]="proyectoProcess"
            [(value)]="selectedProyect"
            (selectionChange)="onSelectionProyectoChange($event)"
            formControlName="proyecto"
            [placeholder]="returnPlaceholder('un proyecto *', 'los proyectos')">
            <mat-option *ngFor="let proyecto of proyectos" [value]="proyecto">{{
              proyecto.nombre
            }}</mat-option>
          </mat-select>
          <mat-error
            class="error-required"
            *ngIf="callHandleError('proyecto', 'required', projectForm)"
            >{{ msgErrorRequired }}</mat-error
          >
        </div>
        <div class="col-4">
          <label for="sprint" class="col-12">SPRINT</label>
          <mat-select
            id="sprint"
            class="col-12"
            [ngClass]="sprintProcess"
            [(value)]="selectedSprint"
            (selectionChange)="onSelectionSprintsChange($event)"
            formControlName="sprint"
            [placeholder]="returnPlaceholder('un sprint *', 'los sprints')">
            <mat-option *ngFor="let sprint of sprints" [value]="sprint">{{
              sprint.nombre
            }}</mat-option>
          </mat-select>
          <mat-error
            class="error-required"
            *ngIf="callHandleError('sprint', 'required', projectForm)"
            >{{ msgErrorRequired }}</mat-error
          >
        </div>
        <div class="col-4">
          <label for="historiaJira" class="col-12">HISTORIA JIRA</label>
          <mat-select
            id="historiaJira"
            class="col-12"
            [ngClass]="historiaJiraProcess"
            [(value)]="selectedHistoriaJira"
            (selectionChange)="onSelectionHistoriaJiraChange($event)"
            formControlName="historiaJira"
            [placeholder]="
              returnPlaceholder('un código de Jira *', 'los códigos de Jira')
            ">
            <mat-option
              *ngFor="let historiaJira of historiasJira"
              [value]="historiaJira"
              >{{ historiaJira.descripcion }}</mat-option
            >
          </mat-select>
          <mat-error
            class="error-required"
            *ngIf="callHandleError('historiaJira', 'required', projectForm)"
            >{{ msgErrorRequired }}</mat-error
          >
        </div>
      </div>
      <div class="row mt-1">
        <div class="col-4">
          <label for="owner" class="col-12">RESPONSABLE TAREA</label>
          <input
            id="owner"
            type="text"
            class="col-12"
            minlength="8"
            maxlength="20"
            formControlName="owner"
            placeholder="Inserta el nombre del responsable *" />
          <mat-error
            class="error-required"
            *ngIf="callHandleError('owner', 'required', projectForm)"
            >{{ msgErrorRequired }}</mat-error
          >
          <mat-error
            class="error-required"
            *ngIf="callHandleError('owner', 'invalidPattern', projectForm)"
            >{{ msgErrorPattern }}</mat-error
          >
        </div>
        <div class="col-8">
          <label for="notas" class="col-12">NOTAS</label>
          <input
            id="notas"
            type="text"
            class="col-12"
            formControlName="notas"
            maxlength="255"
            placeholder="Añade alguna nota (Opcional)" />
          <mat-error
            class="error-required"
            *ngIf="callHandleError('notas', 'invalidPattern', projectForm)"
            >{{ msgErrorPattern }}</mat-error
          >
        </div>
      </div>
    </div>

    <div id="components-container" formArrayName="componentes">
      <div
        *ngFor="let componente of componentes.controls; let i = index"
        [formGroupName]="i">
        <app-dynamic-content
          [dynamicForm]="getComponenteFormGroup(i)"
          (remove)="removeComponent(i)">
        </app-dynamic-content>
      </div>
    </div>

    <div class="action-buttons">
      <button
        id="add-component"
        class="add-component"
        type="button"
        (click)="addComponent()">
        <img src="assets/icons/addIcon.svg" alt="Añadir" />
      </button>
      <button id="save-button" class="save-button" type="submit">
        Guardar
      </button>
    </div>
  </form>
</div>
